<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Patient Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="./patient.css" />
  </head>
  <body>
    <div class="container">
      <!-- Sidebar -->
      <div class="sidebar">
        <h2 class="logo">
          <i class="fas fa-hospital"></i>
          <span>MedElite</span>
        </h2>
        <nav>
          <ul class="nav-links">
            <li>
              <a href="#appointments">
                <i class="fas fa-calendar-alt"></i><span>Appointments</span>
              </a>
            </li>
            <li>
              <a href="#history">
                <i class="fas fa-file-medical"></i><span>Medical History</span>
              </a>
            </li>
            <li>
              <a href="#billing">
                <i class="fas fa-credit-card"></i><span>Billing</span>
              </a>
            </li>
            <li>
              <a href="#upload">
                <i class="fas fa-upload"></i><span>Upload Reports</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <header class="header">
          <div class="welcome">
            <i class="fas fa-user-md"></i>
            <span id="welcomeMessage">Welcome</span>
          </div>
          <button class="logout-btn">
            <i class="fas fa-sign-out-alt"></i> Logout
          </button>
        </header>

        <section id="appointments" class="card">
          <h2>
            <i class="far fa-calendar-alt"></i>
            <span>View & Book Appointments</span>
          </h2>

          <!-- Upcoming Appointments Table -->
          <div class="appointments-table">
            <h3>Your Appointments</h3>
            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Time</th>
                  <th>Doctor</th>
                  <th>Specialty</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="appointmentsTableBody">
                <!-- Appointments will be populated by JavaScript -->
              </tbody>
            </table>
          </div>

          <!-- Appointment Form -->
          <div id="appointmentForm" class="appointment-form">
            <h3>Book an Appointment</h3>

            <!-- Medical Specialty Selection -->
            <div class="form-group">
              <label for="medicalField">Medical Field:</label>
              <select id="medicalField" required>
                <option value="">Select a medical field</option>
                <!-- Options will be populated by JavaScript -->
              </select>
            </div>

            <!-- Doctor Selection -->
            <div
              id="doctorSelection"
              class="doctor-options"
              style="display: none"
            >
              <h4>Available Doctors:</h4>
              <div id="doctorOptionsContainer">
                <!-- Doctor options will be populated by JavaScript -->
              </div>
            </div>

            <!-- Date Selection -->
            <div class="form-group" id="dateGroup" style="display: none">
              <label for="appointmentDate">Select Date:</label>
              <select id="appointmentDate" required>
                <option value="">Select a date</option>
                <!-- Dates will be populated by JavaScript -->
              </select>
            </div>

            <!-- Time Slot Selection -->
            <div class="form-group" id="timeSlotGroup" style="display: none">
              <label for="appointmentTime">Select Time Slot:</label>
              <select id="appointmentTime" required>
                <option value="">Select a time slot</option>
                <!-- Time slots will be populated by JavaScript -->
              </select>
            </div>

            <!-- Age -->
            <div class="form-group">
              <label for="age">Age:</label>
              <input
                type="number"
                id="age"
                placeholder="Enter your age"
                min="1"
                max="120"
                required
              />
            </div>

            <!-- Gender -->
            <div class="form-group">
              <label>Gender:</label>
              <div class="radio-group">
                <input
                  type="radio"
                  id="male"
                  name="gender"
                  value="male"
                  required
                />
                <label for="male">Male</label>

                <input type="radio" id="female" name="gender" value="female" />
                <label for="female">Female</label>

                <input type="radio" id="other" name="gender" value="other" />
                <label for="other">Other</label>
              </div>
            </div>

            <!-- Phone -->
            <div class="form-group">
              <label for="phone">Phone:</label>
              <input
                type="tel"
                id="phone"
                placeholder="Enter your phone number"
                required
                pattern="[0-9]{10}"
                title="Please enter a 10-digit phone number"
              />
            </div>

            <!-- Address -->
            <div class="form-group">
              <label for="address">Address:</label>
              <textarea
                id="address"
                placeholder="Enter your full address"
                required
              ></textarea>
            </div>

            <!-- Additional Details -->
            <div class="form-group">
              <label for="reason">Reason for Appointment:</label>
              <textarea
                id="reason"
                placeholder="Describe the purpose of your visit"
                required
              ></textarea>
            </div>

            <!-- Submit Button -->
            <div class="form-submit">
              <button id="submitAppointment">Submit</button>
            </div>
          </div>
        </section>

        <section id="history" class="card">
          <h2>
            <i class="fas fa-notes-medical"></i>
            <span>Medical History & Prescriptions</span>
          </h2>
          <p class="no-records">No records found.</p>
        </section>

        <section id="billing" class="card">
          <h2>
            <i class="fas fa-credit-card"></i> <span>Payment & Billing</span>
          </h2>
          <div class="billing-table">
            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Amount</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="billingTableBody">
                <!-- Billing data will be populated by JavaScript -->
              </tbody>
            </table>
          </div>
          <div id="billDetails" class="bill-details" style="display: none">
            <!-- Bill details will be populated by JavaScript -->
          </div>
        </section>

        <section id="upload" class="card">
          <h2>
            <i class="fas fa-file-upload"></i> <span>Upload Reports</span>
          </h2>
          <div class="upload-container">
            <input type="file" id="reportFile" />
            <button class="upload-btn">
              <i class="fas fa-upload"></i> <span>Upload</span>
            </button>
          </div>
        </section>
      </div>
    </div>
    <script>
      // Base API URL
      const API_BASE_URL = "http://localhost:5000/api";

      // DOM Elements
      const medicalFieldSelect = document.getElementById("medicalField");
      const doctorSelection = document.getElementById("doctorSelection");
      const doctorOptionsContainer = document.getElementById(
        "doctorOptionsContainer"
      );
      const dateGroup = document.getElementById("dateGroup");
      const appointmentDate = document.getElementById("appointmentDate");
      const timeSlotGroup = document.getElementById("timeSlotGroup");
      const appointmentTime = document.getElementById("appointmentTime");
      const submitButton = document.getElementById("submitAppointment");
      const welcomeMessage = document.getElementById("welcomeMessage");
      const phoneInput = document.getElementById("phone");
      const addressInput = document.getElementById("address");
      const appointmentsTableBody = document.getElementById(
        "appointmentsTableBody"
      );

      // Current user data (would be set after login)
      let currentUser = {
        id: null,
        name: null,
        email: null,
        phone: null,
        address: null,
        role: "patient",
      };

      // Initialize the application when DOM is loaded
      document.addEventListener("DOMContentLoaded", function () {
        const tok = localStorage.token;

        function parseJwt(token) {
          try {
            const base64Url = token.split(".")[1];
            const base64 = base64Url.replace(/-/g, "+").replace(/_/g, "/");
            const jsonPayload = decodeURIComponent(
              atob(base64)
                .split("")
                .map(
                  (c) => `%${("00" + c.charCodeAt(0).toString(16)).slice(-2)}`
                )
                .join("")
            );
            return JSON.parse(jsonPayload);
          } catch (e) {
            return null;
          }
        }

        // Get user data from session
        const userData = parseJwt(tok);
        currentUser = userData;

        if (userData) {
          welcomeMessage.textContent = `Welcome, ${userData.name}`;
          loadPatientPrescriptions();
          loadPatientAppointments();

          // Pre-fill patient information if available
          if (currentUser.phone) {
            phoneInput.value = userData.phone;
          }
          if (currentUser.address) {
            addressInput.value = userData.address;
          }
        }

        // Populate medical fields dropdown (hardcoded for simplicity)
        const medicalFields = [
          "General Practitioner",
          "Cardiology",
          "Neurology",
          "Orthopedics",
        ];
        medicalFields.forEach((field) => {
          const option = document.createElement("option");
          option.value = field;
          option.textContent = field;
          medicalFieldSelect.appendChild(option);
        });

        // Handle medical field selection change
        medicalFieldSelect.addEventListener("change", async function () {
          const selectedField = this.value;
          doctorOptionsContainer.innerHTML = "";
          dateGroup.style.display = "none";
          timeSlotGroup.style.display = "none";

          if (selectedField) {
            try {
              // Fetch doctors by specialization from our API
              const response = await fetch(
                `${API_BASE_URL}/patient/doctors/${encodeURIComponent(
                  selectedField
                )}`
              );
              const doctors = await response.json();

              if (doctors.length === 0) {
                doctorOptionsContainer.innerHTML =
                  "<p>No doctors available in this specialty</p>";
                return;
              }

              // Add doctor options
              doctors.forEach((doctor) => {
                const doctorOption = document.createElement("div");
                doctorOption.className = "doctor-option";

                const radioInput = document.createElement("input");
                radioInput.type = "radio";
                radioInput.name = "doctor";
                radioInput.id = doctor._id;
                radioInput.value = doctor._id;

                const label = document.createElement("label");
                label.htmlFor = doctor._id;
                label.className = "doctor-info";

                const nameDiv = document.createElement("div");
                nameDiv.className = "doctor-name";
                nameDiv.textContent = doctor.userId.name;

                const detailsDiv = document.createElement("div");
                detailsDiv.className = "doctor-specialty";
                detailsDiv.textContent = `${doctor.specialization}`;

                label.appendChild(nameDiv);
                label.appendChild(detailsDiv);

                doctorOption.appendChild(radioInput);
                doctorOption.appendChild(label);

                doctorOptionsContainer.appendChild(doctorOption);
              });

              doctorSelection.style.display = "block";
            } catch (error) {
              console.error("Error fetching doctors:", error);
              alert("Failed to load doctors. Please try again.");
            }
          } else {
            doctorSelection.style.display = "none";
          }
        });

        // Handle doctor selection change
        doctorOptionsContainer.addEventListener("change", async function (e) {
          if (e.target.name === "doctor") {
            const doctorId = e.target.value;

            try {
              // Fetch available dates for selected doctor
              const response = await fetch(
                `${API_BASE_URL}/patient/slots/${doctorId}`
              );
              const availableSlots = await response.json();

              // Extract unique dates from available slots
              const uniqueDates = [
                ...new Set(availableSlots.map((slot) => slot.date)),
              ];

              // Populate date dropdown
              appointmentDate.innerHTML =
                '<option value="">Select a date</option>';
              uniqueDates.forEach((date) => {
                const option = document.createElement("option");
                option.value = date;
                option.textContent = new Date(date).toLocaleDateString();
                appointmentDate.appendChild(option);
              });

              dateGroup.style.display = "block";
              timeSlotGroup.style.display = "none";
            } catch (error) {
              console.error("Error fetching available dates:", error);
              alert("Failed to load available dates. Please try again.");
            }
          }
        });

        // Handle date selection change
        appointmentDate.addEventListener("change", async function () {
          const selectedDate = this.value;
          if (!selectedDate) {
            timeSlotGroup.style.display = "none";
            return;
          }

          const selectedDoctor = document.querySelector(
            'input[name="doctor"]:checked'
          );
          if (!selectedDoctor) {
            alert("Please select a doctor first");
            this.value = "";
            return;
          }

          try {
            // Fetch available slots for selected doctor and date
            const response = await fetch(
              `${API_BASE_URL}/patient/slots/${selectedDoctor.value}`
            );
            const allSlots = await response.json();

            // Filter slots for selected date
            const availableSlots = allSlots.filter(
              (slot) => slot.date === selectedDate && !slot.isBooked
            );

            // Clear previous time slots
            appointmentTime.innerHTML =
              '<option value="">Select a time slot</option>';

            // Add available time slots
            availableSlots.forEach((slot) => {
              const option = document.createElement("option");
              option.value = slot.time;
              option.textContent = slot.time;
              appointmentTime.appendChild(option);
            });

            // Show time slot selection
            timeSlotGroup.style.display = "block";
          } catch (error) {
            console.error("Error fetching time slots:", error);
            alert("Failed to load available time slots. Please try again.");
          }
        });

        // Handle form submission
        submitButton.addEventListener("click", handleFormSubmit);

        // Initialize billing section
        initializeBillingSection();

        // Initialize logout button
        document
          .querySelector(".logout-btn")
          .addEventListener("click", function () {
            localStorage.removeItem("token");
            window.location.href = "login.html"; // Redirect to login page
          });

        // Initialize upload button (simplified)
        document
          .querySelector(".upload-btn")
          .addEventListener("click", function () {
            const fileInput = document.getElementById("reportFile");
            if (fileInput.files.length > 0) {
              alert(
                "File uploaded successfully! (This would be sent to the backend in a real app)"
              );
              fileInput.value = "";
            } else {
              alert("Please select a file to upload.");
            }
          });
      });

      // Load patient appointments
      async function loadPatientAppointments() {
        try {
          const response = await fetch(
            `${API_BASE_URL}/patient/appointments/${currentUser.userId}`
          );
          const appointments = await response.json();

          // Clear existing table rows
          appointmentsTableBody.innerHTML = "";

          if (appointments.length > 0) {
            appointments.forEach((appointment) => {
              const row = document.createElement("tr");

              const dateCell = document.createElement("td");
              dateCell.textContent = new Date(
                appointment.date
              ).toLocaleDateString();

              const timeCell = document.createElement("td");
              timeCell.textContent = appointment.time;

              const doctorCell = document.createElement("td");
              console.log(appointment);
              doctorCell.textContent = `Dr. ${appointment.doctorId.userId.name}`;

              const specialtyCell = document.createElement("td");
              specialtyCell.textContent = appointment.doctorId.specialization;

              const statusCell = document.createElement("td");
              statusCell.textContent =
                appointment.status.charAt(0).toUpperCase() +
                appointment.status.slice(1);
              statusCell.className = appointment.status;

              const actionCell = document.createElement("td");
              if (
                appointment.status !== "completed" &&
                appointment.status !== "cancelled"
              ) {
                const cancelBtn = document.createElement("button");
                cancelBtn.className = "cancel-btn";
                cancelBtn.textContent = "Cancel";
                cancelBtn.addEventListener("click", () =>
                  cancelAppointment(appointment._id)
                );
                actionCell.appendChild(cancelBtn);
              } else {
                actionCell.textContent = "No action";
              }

              row.appendChild(dateCell);
              row.appendChild(timeCell);
              row.appendChild(doctorCell);
              row.appendChild(specialtyCell);
              row.appendChild(statusCell);
              row.appendChild(actionCell);

              appointmentsTableBody.appendChild(row);
            });
          } else {
            const row = document.createElement("tr");
            const cell = document.createElement("td");
            cell.colSpan = 6;
            cell.textContent = "No appointments scheduled";
            row.appendChild(cell);
            appointmentsTableBody.appendChild(row);
          }
        } catch (error) {
          console.error("Error loading appointments:", error);
          const row = document.createElement("tr");
          const cell = document.createElement("td");
          cell.colSpan = 6;
          cell.textContent = "Error loading appointments";
          row.appendChild(cell);
          appointmentsTableBody.appendChild(row);
        }
      }

      // Cancel appointment function
      async function cancelAppointment(appointmentId) {
        if (!confirm("Are you sure you want to cancel this appointment?")) {
          return;
        }

        try {
          const response = await fetch(
            `${API_BASE_URL}/patient/appointments/${appointmentId}`,
            {
              method: "DELETE",
              headers: {
                "Content-Type": "application/json",
              },
            }
          );

          if (!response.ok) {
            throw new Error("Failed to cancel appointment");
          }

          alert("Appointment cancelled successfully");
          loadPatientAppointments();
        } catch (error) {
          console.error("Error cancelling appointment:", error);
          alert("Failed to cancel appointment. Please try again.");
        }
      }

      // Load patient prescriptions
      async function loadPatientPrescriptions() {
        try {
          const response = await fetch(
            `${API_BASE_URL}/patient/prescriptions/${currentUser.userId}`
          );
          const prescriptions = await response.json();

          const historySection = document.getElementById("history");
          const noRecordsMsg = historySection.querySelector(".no-records");

          if (prescriptions.length > 0) {
            noRecordsMsg.style.display = "none";

            prescriptions.forEach((prescription) => {
              const prescriptionDiv = document.createElement("div");
              prescriptionDiv.className = "prescription-card";

              const date = new Date(
                prescription.createdAt
              ).toLocaleDateString();
              const doctorName = prescription.doctorId.name;

              prescriptionDiv.innerHTML = `
                <h3>Prescription from Dr. ${doctorName} - ${date}</h3>
                ${
                  prescription.medicines.length > 0
                    ? `
                  <h4>Medicines:</h4>
                  <ul>
                    ${prescription.medicines
                      .map(
                        (med) =>
                          `<li>${med.name} - ${med.dosage} for ${med.duration}</li>`
                      )
                      .join("")}
                  </ul>
                `
                    : ""
                }
                ${
                  prescription.tests.length > 0
                    ? `
                  <h4>Tests:</h4>
                  <ul>
                    ${prescription.tests
                      .map((test) => `<li>${test.name}</li>`)
                      .join("")}
                  </ul>
                `
                    : ""
                }
                ${
                  prescription.notes
                    ? `<p><strong>Notes:</strong> ${prescription.notes}</p>`
                    : ""
                }
              `;

              historySection.appendChild(prescriptionDiv);
            });
          } else {
            noRecordsMsg.style.display = "block";
          }
        } catch (error) {
          console.error("Error loading prescriptions:", error);
        }
      }

      // Handle form submission
      async function handleFormSubmit() {
        // Get form elements
        const medicalField = document.getElementById("medicalField");
        const doctor = document.querySelector('input[name="doctor"]:checked');
        const appointmentDate = document.getElementById("appointmentDate");
        const appointmentTime = document.getElementById("appointmentTime");
        const age = document.getElementById("age");
        const gender = document.querySelector('input[name="gender"]:checked');
        const phone = document.getElementById("phone");
        const address = document.getElementById("address");
        const reason = document.getElementById("reason");

        console.log(doctor);

        // Validate form
        if (
          !validateForm(
            medicalField,
            doctor,
            appointmentDate,
            appointmentTime,
            age,
            gender,
            phone,
            address,
            reason
          )
        ) {
          return false;
        }

        try {
          console.log(doctor);
          const response = await fetch(`${API_BASE_URL}/patient/appointments`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              patientId: currentUser.userId,
              doctorId: doctor.value,
              date: appointmentDate.value,
              time: appointmentTime.value,
              age: age.value,
              gender: gender.value,
              phone: phone.value,
              address: address.value,
              reason: reason.value,
            }),
          });

          if (!response.ok) {
            throw new Error("Failed to book appointment");
          }

          const appointment = await response.json();
          alert(
            `Appointment booked successfully for ${new Date(
              appointmentDate.value
            ).toLocaleDateString()} at ${appointmentTime.value}`
          );
          resetForm();
          loadPatientAppointments();
        } catch (error) {
          console.error("Error booking appointment:", error);
          alert("Failed to book appointment. Please try again.");
        }
      }

      // Helper functions
      function validateForm(
        medicalField,
        doctor,
        appointmentDate,
        appointmentTime,
        age,
        gender,
        phone,
        address,
        reason
      ) {
        if (!medicalField.value) {
          alert("Please select a medical field");
          medicalField.focus();
          return false;
        }

        if (!doctor) {
          alert("Please select a doctor");
          return false;
        }

        if (!appointmentDate.value) {
          alert("Please select an appointment date");
          appointmentDate.focus();
          return false;
        }

        if (!appointmentTime.value) {
          alert("Please select an appointment time");
          appointmentTime.focus();
          return false;
        }

        if (!age.value || age.value < 1 || age.value > 120) {
          alert("Please enter a valid age between 1 and 120");
          age.focus();
          return false;
        }

        if (!gender) {
          alert("Please select your gender");
          return false;
        }

        if (!phone.value || !/^[0-9]{10}$/.test(phone.value)) {
          alert("Please enter a valid 10-digit phone number");
          phone.focus();
          return false;
        }

        if (!address.value) {
          alert("Please enter your address");
          address.focus();
          return false;
        }

        if (!reason.value) {
          alert("Please describe the reason for your appointment");
          reason.focus();
          return false;
        }

        return true;
      }

      function resetForm() {
        document.getElementById("appointmentForm").reset();
        document.getElementById("doctorSelection").style.display = "none";
        document.getElementById("dateGroup").style.display = "none";
        document.getElementById("timeSlotGroup").style.display = "none";

        // Keep phone and address values if they exist
        if (currentUser.phone) {
          document.getElementById("phone").value = currentUser.phone;
        }
        if (currentUser.address) {
          document.getElementById("address").value = currentUser.address;
        }
      }
      async function initializeBillingSection() {
        try {
          const billingTableBody = document.getElementById("billingTableBody");
          const billDetails = document.getElementById("billDetails");

          // Clear existing data
          billingTableBody.innerHTML = "";

          // Fetch bills directly for the patient using their ID
          const billsResponse = await fetch(
            `${API_BASE_URL}/patient/prescriptions/bill/${currentUser.userId}`
          );

          if (!billsResponse.ok) {
            throw new Error("Failed to fetch bills");
          }

          const billsData = await billsResponse.json();

          if (!billsData || billsData.length === 0) {
            const row = document.createElement("tr");
            const cell = document.createElement("td");
            cell.colSpan = 4;
            cell.textContent = "No billing records found";
            row.appendChild(cell);
            billingTableBody.appendChild(row);
            return;
          }

          // Process each bill
          billsData.forEach((billData) => {
            if (!billData.bill) return;

            const bill = billData.bill;
            const date = new Date().toLocaleDateString(); // Since we don't have date in the response

            // Create table row
            const row = document.createElement("tr");

            // Date cell
            const dateCell = document.createElement("td");
            dateCell.textContent = date;

            // Amount cell
            const amountCell = document.createElement("td");
            amountCell.textContent = `₹${bill.amount}`;

            // Status cell
            const statusCell = document.createElement("td");
            statusCell.textContent = "Paid";
            statusCell.className = "paid";

            // Action cell
            const actionCell = document.createElement("td");
            actionCell.className = "action-cell";

            const viewButton = document.createElement("button");
            viewButton.className = "viewBillBtn";
            viewButton.textContent = "View Bill";
            viewButton.addEventListener("click", () =>
              showBillDetails(bill, date)
            );

            actionCell.appendChild(viewButton);
            row.appendChild(dateCell);
            row.appendChild(amountCell);
            row.appendChild(statusCell);
            row.appendChild(actionCell);

            billingTableBody.appendChild(row);
          });
        } catch (error) {
          console.error("Error loading billing data:", error);
          const row = document.createElement("tr");
          const cell = document.createElement("td");
          cell.colSpan = 4;
          cell.textContent = "Error loading billing information";
          row.appendChild(cell);
          billingTableBody.appendChild(row);
        }
      }

      function showBillDetails(bill, date) {
        const billDetails = document.getElementById("billDetails");

        billDetails.innerHTML = `
        <h3>Invoice Details - ${date}</h3>
        <p class="bill-description">Billing Breakdown:</p>
        <div class="bill-items">
            ${
              bill.medicines && bill.medicines.length > 0
                ? `
                    <h4>Medicines</h4>
                    <ul>
                        ${bill.medicines
                          .map((med) => `<li>${med.name} - ₹${med.price}</li>`)
                          .join("")}
                    </ul>
                    `
                : ""
            }
            ${
              bill.tests && bill.tests.length > 0
                ? `
                    <h4>Tests</h4>
                    <ul>
                        ${bill.tests
                          .map(
                            (test) => `<li>${test.name} - ₹${test.price}</li>`
                          )
                          .join("")}
                    </ul>
                    `
                : ""
            }
            ${
              bill.otherCharges
                ? `
                    <h4>Other Charges</h4>
                    <ul>
                        <li>Service Charges - ₹${bill.otherCharges}</li>
                    </ul>
                    `
                : ""
            }
            <h4>Total Amount:</h4>
            <p id="billTotal">₹${bill.amount}</p>
        </div>
    `;

        billDetails.style.display = "block";
      }
    </script>
  </body>
</html>
